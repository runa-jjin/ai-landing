# 관리자 페이지 사용 가이드

## 🔐 관리자 설정

### 1단계: 관리자 비밀번호 설정

`.env.local` 파일에 추가:

```bash
# 관리자 페이지 비밀번호 (본인만 아는 비밀번호로 변경하세요!)
ADMIN_PASSWORD=your-secure-password-123
```

⚠️ **중요**: 
- 강력한 비밀번호 사용 권장 (최소 12자, 영문+숫자+특수문자)
- 이 비밀번호는 절대 공유하지 마세요
- `.env.local` 파일은 Git에 업로드되지 않습니다 (.gitignore에 포함)

### 2단계: 서버 재시작

```bash
# Ctrl + C로 서버 종료 후
npm run dev
```

---

## 📋 관리자 페이지 사용 방법

### 접속

```
http://localhost:3000/admin
```

또는 배포 후:
```
https://your-domain.com/admin
```

### 로그인

1. 관리자 비밀번호 입력
2. "로그인" 클릭

---

## 🎯 주요 기능

### 1. 사용자 목록 조회

- 모든 사용자의 이메일, 이름, 가입일 표시
- 현재 플랜 (Free/Pro) 확인
- 사용량 확인

### 2. 사용자 검색

- 이메일 또는 이름으로 검색
- 실시간 검색 가능

### 3. Pro 업그레이드 ⭐

**사용 시나리오:**

1. 고객이 카카오페이로 송금
2. 고객이 이메일로 "입금자명: 홍길동" 전송
3. 관리자 페이지에서 고객 이메일 검색
4. **"⬆️ Pro로 업그레이드" 버튼 클릭**
5. 완료! → 고객은 즉시 무제한 사용 가능

**효과:**
- `plan_type`: free → pro
- 사용량 제한 해제
- 고객에게 "Pro 요금제" 표시

### 4. Free로 다운그레이드

- Pro 플랜 만료 시 사용
- "⬇️ Free로 변경" 버튼 클릭

### 5. 사용량 초기화

- 고객의 사용 횟수를 0으로 리셋
- 매월 초 또는 특별 이벤트 시 사용
- "🔄 사용량 초기화" 버튼 클릭

### 6. 사용자 삭제

- 회원 탈퇴 요청 시 사용
- "🗑️ 삭제" 버튼 클릭
- ⚠️ **주의**: 되돌릴 수 없습니다!

---

## 🔄 일반적인 워크플로우

### 새로운 Pro 고객 처리

1. **고객**: 카카오페이로 ₩19,000 송금
2. **고객**: tears0427@gmail.com으로 이메일 전송
   ```
   제목: Pro 플랜 결제 완료
   내용: 
   - 입금자명: 홍길동
   - 가입 이메일: customer@example.com
   - 결제 금액: 19,000원
   ```
3. **관리자**: `/admin` 접속
4. **관리자**: "customer@example.com" 검색
5. **관리자**: "⬆️ Pro로 업그레이드" 클릭
6. **완료**: 고객에게 이메일로 안내
   ```
   안녕하세요 홍길동님,
   Pro 플랜이 활성화되었습니다!
   이제 무제한으로 이용하실 수 있습니다.
   ```

**소요 시간**: 약 10초 ⚡

---

## 🛡️ 보안 주의사항

### 1. 비밀번호 관리

- ✅ 강력한 비밀번호 사용
- ✅ 정기적으로 비밀번호 변경
- ❌ 비밀번호 공유 금지
- ❌ 공용 PC에서 접속 금지

### 2. 관리자 페이지 접속

- ✅ 본인만 접속
- ✅ HTTPS 사용 (배포 후)
- ❌ 공용 와이파이에서 접속 금지

### 3. 배포 시

Vercel 환경 변수에 추가:

```bash
ADMIN_PASSWORD=your-production-password
```

---

## 🔧 트러블슈팅

### 로그인이 안돼요

**원인**: 환경 변수 미설정 또는 서버 재시작 필요

**해결**:
1. `.env.local`에 `ADMIN_PASSWORD` 추가
2. 서버 재시작 (Ctrl + C 후 `npm run dev`)

### 사용자 목록이 안 보여요

**원인**: Supabase 연결 문제

**해결**:
1. Supabase 환경 변수 확인
2. 브라우저 콘솔(F12)에서 에러 확인
3. Cursor 터미널에서 에러 확인

### Pro 업그레이드가 안돼요

**원인**: RLS 정책 또는 Service Role Key 문제

**해결**:
1. `SUPABASE_SERVICE_ROLE_KEY` 환경 변수 확인
2. Supabase RLS 정책 확인 (`Service role full access` 필요)

---

## 📊 통계 확인 (선택사항)

### Supabase Dashboard에서

1. Supabase Dashboard → Table Editor
2. `user_usage` 테이블 선택
3. 전체 사용자 현황 확인:
   - Free 플랜 사용자 수
   - Pro 플랜 사용자 수
   - 총 사용량 통계

---

## 🚀 배포 후 설정

### Vercel 환경 변수 추가

1. Vercel Dashboard → Project Settings
2. Environment Variables
3. 추가:
   ```
   Key: ADMIN_PASSWORD
   Value: your-production-password
   Environment: Production, Preview, Development (모두 체크)
   ```
4. Redeploy

### 관리자 페이지 접속

```
https://your-domain.com/admin
```

---

## 💡 팁

### 빠른 업그레이드

고객 이메일을 미리 복사해두고:
1. `/admin` 접속
2. Ctrl + V로 이메일 붙여넣기
3. Enter 또는 "검색" 클릭
4. "Pro로 업그레이드" 클릭

→ **5초 완료!** ⚡

### 고객 응대 템플릿

**결제 확인 이메일:**
```
안녕하세요,
Pro 플랜 결제가 확인되었습니다.

✅ 플랜: Pro (무제한)
✅ 활성화: 즉시
✅ 유효기간: 1개월

이제 제한 없이 이용하실 수 있습니다!
감사합니다.
```

---

## ❓ 자주 묻는 질문

**Q: 배치로 여러 명을 한번에 업그레이드할 수 있나요?**
A: 현재는 한 명씩 처리합니다. 하지만 클릭 한 번이라 매우 빠릅니다.

**Q: Pro 플랜 기간을 설정할 수 있나요?**
A: 현재 버전에는 없습니다. 매월 수동으로 다운그레이드하거나, 추후 자동 만료 기능 추가 가능합니다.

**Q: 사용 이력을 볼 수 있나요?**
A: Supabase Dashboard에서 `user_usage` 테이블의 `updated_at` 필드를 확인하세요.

---

## 📞 문제 발생 시

1. 브라우저 콘솔(F12) 확인
2. Cursor 터미널 에러 확인
3. Supabase 로그 확인

행운을 빕니다! 🎉

